
<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>TrustEval Provenance</title>
<style>body{background:#0a0c0d;color:#e7eaed;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif} .bubble{display:none!important}</style>
<link rel="stylesheet" href="config/theme.css?v=20250928194153">
</head><body>
<header>
  <a class="btn" href="https://theoyez.org" target="_blank">theoyez.org</a>
  <nav>
    <a class="btn" href="web/compare.html">Compare</a>
    <a class="btn" href="web/how-it-works.html">How it works</a>
    <a class="btn" href="README.md" target="_blank">README</a>
  </nav>
</header>
<div class="container">
  <h1>TrustEval Provenance</h1>
  <p class="lead">Everything in Plus, with cryptographic provenance folded into Trust.</p>
  <div class="small">Click a column header to sort. Hover a header for definitions. Use ▸ to expand drawers. Model label stays when expanded.</div>
  <input id="filter" class="input" placeholder="Filter by run id, model, or meta…">
  <table role="table"><thead><tr id="thead"></tr></thead><tbody id="tbody"></tbody></table>
  <p class="small">Updated: <span id="updated">—</span></p>
</div>
<script>
const pct = (x)=> (x*100).toFixed(1)+'%';
const labelMap = {run_id:'Run', model:'Model', accuracy:'Accuracy', grounding:'Grounding', safety:'Safety', robustness:'Robustness', bias:'Bias', calibration:'Calibration', trust_score:'Trust', audit:'Audit', provenance:'Provenance', report:'Report'};
const tipMap = {run_id:'Unique run identifier.', model:'System/model. Click ▸ to reveal meta; label stays visible when expanded.', accuracy:'Partial-credit vs expected (exact/token/regex/edit).', grounding:'Citations must be allowed per-item; capped if not in retrieved top-k.', safety:'PII/Toxicity/Policy regex packs apply bounded deductions.', robustness:'Answer stability under minor perturbations.', bias:'Score reduction for biased outputs (rules with sampling).', calibration:'Reliability-of-confidence (ECE proxy).', trust_score:'0.6×Acc + 0.3×Ground + 0.1×Safety.'};
function pill(s){const c=s==='ok'?'ok':(s==='warn'?'warn':'err');return `<span class="pill ${c}">${s}</span>`;}
function metaBlock(m){if(!m)return'<div class=small>—</div>';const keys=['model','dataset','prompt_cfg','retriever','date','sig','prov_root'];return '<div class="meta-kv">'+keys.filter(k=>m[k]).map(k=>`<div class=small><b>${k}</b></div><div class=small>${m[k]}</div>`).join('')+'</div>';}
function auditBlock(a){if(!a)return'<div class=small>—</div>';const items=(a.trail||[]).map(t=>`<li><code>${t.doc}</code> · chunk <b>${t.chunk}</b> · score ${t.score}</li>`).join('')||'<li>—</li>';const cites=(a.citations||[]).map(c=>`<li><code>${c}</code></li>`).join('')||'<li>—</li>';return `<div class=small><div>Status: ${pill(a.status||'warn')}</div><div style="margin-top:6px">Candidates:</div><ul class=small>${items}</ul><div>Citations:</div><ul class=small>${cites}</ul></div>`;}
function provBlock(p){if(!p)return'<div class=small>—</div>';let s=`<div class=small><div>Status: ${pill(p.status||'warn')}</div><div>Root: <code>${p.root||'—'}</code>`;if(p.bundle){s+=` · <a href="${p.bundle}">bundle</a>`}s+='</div></div>';return s;}
let runs=[], sortKey='trust_score', sortAsc=false, term='';
function buildHead(cols){const thead=document.getElementById('thead');thead.innerHTML=cols.map(k=>{const sortable=!['report','audit','provenance'].includes(k);const arrow=sortable?'<span class="arrow">↕</span>':'';const tip=tipMap[k]||'';return `<th id="th-${k}" class="${sortable?'sortable':''}" title="${tip}"><div class="tip" tabindex="0">${labelMap[k]||k} ${arrow}<div class="bubble">${tip}</div></div></th>`}).join('');thead.addEventListener('click',e=>{const th=e.target.closest('.sortable');if(!th)return;const k=th.id.replace('th-','');sortAsc=sortKey===k?!sortAsc:true;sortKey=k;runs.sort((a,b)=>(sortAsc?1:-1)*(((b[k]??0)-(a[k]??0))));document.querySelectorAll('.sortable .arrow').forEach(a=>a.textContent='↕');th.querySelector('.arrow').textContent=sortAsc?'▲':'▼';renderRows(cols);});}
function renderRows(cols){const tbody=document.getElementById('tbody');const rows=runs.filter(r=>{if(!term)return true;const hay=(r.run_id+' '+(r.model||'')+' '+Object.values(r.meta||{}).join(' ')).toLowerCase();return hay.includes(term);});tbody.innerHTML=rows.map(r=>{let tds=`<td>${r.run_id}</td>`;const modelBtn=`<div class="chev" data-target="meta_${r.run_id}"><span class="arrow">▸</span><span class="label">${r.model||'—'}</span> <span class="small">· meta</span></div>`;tds+=`<td>${modelBtn}</td>`;cols.forEach(k=>{if(['run_id','model','audit','provenance','report'].includes(k))return;const v=r[k]??0;tds+=`<td class="right">${pct(v)}</td>`});if(cols.includes('audit')){tds+=`<td>${pill((r.audit||{}).status||'warn')} <span class="chev" data-target="audit_${r.run_id}">▸</span></td>`}if(cols.includes('provenance')){tds+=`<td>${pill((r.provenance||{}).status||'warn')} <span class="chev" data-target="prov_${r.run_id}">▸</span></td>`}tds+=`<td><a href="${r.report}">Report</a></td>`;let drawers=`<tr><td colspan="${cols.length}">`;drawers+=`<div id="meta_${r.run_id}" class="drawer">${metaBlock(r.meta)}</div>`;if(cols.includes('audit'))drawers+=`<div id="audit_${r.run_id}" class="drawer">${auditBlock(r.audit)}</div>`;if(cols.includes('provenance'))drawers+=`<div id="prov_${r.run_id}" class="drawer">${provBlock(r.provenance)}</div>`;drawers+=`</td></tr>`;return `<tr>${tds}</tr>`+drawers;}).join('');document.querySelectorAll('.chev').forEach(el=>{el.addEventListener('click',()=>{const id=el.dataset.target;const box=document.getElementById(id);if(!box)return;const open=box.style.display!=='block';box.style.display=open?'block':'none';const arrow=el.querySelector('.arrow');if(arrow)arrow.textContent=open?'▾':'▸';const lbl=el.querySelector('.label');if(lbl)lbl.style.opacity=1;});});}
(async function(){const res=await fetch('leaderboard.json');const board=await res.json();runs=board.runs||[];document.getElementById('updated').textContent=board.updated_at||'—';const has=k=>runs.some(r=>k in r);const cols=['run_id','model'];['accuracy','grounding','safety','robustness','bias','calibration','trust_score'].forEach(k=>{if(has(k))cols.push(k)});if(has('audit'))cols.push('audit');if(has('provenance'))cols.push('provenance');cols.push('report');buildHead(cols);runs.sort((a,b)=>(b.trust_score??0)-(a.trust_score??0));document.getElementById('filter').addEventListener('input',e=>{term=(e.target.value||'').toLowerCase();renderRows(cols)});renderRows(cols);})();
</script>

<script>
/* fixed-init */
document.addEventListener('DOMContentLoaded',()=>{
  // Header tip fallback if title wasn't set by template
  document.querySelectorAll('thead th').forEach(th=>{
    if(!th.title && th.querySelector('.tip')) th.title = th.querySelector('.tip').textContent.trim();
  });
  // Audit pill titles
  document.querySelectorAll('td .audit').forEach(a=>{
    const kids=[...a.children];
    if(kids[0] && !kids[0].title) kids[0].title='retrieved@k';
    if(kids[1] && !kids[1].title) kids[1].title='top sources';
    if(kids[2] && !kids[2].title) kids[2].title='consistency';
  });
});
</script>
</body></html>
